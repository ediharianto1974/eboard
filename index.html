<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>e-Board -- Guess the Initial Sounds</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0;
      padding: 20px;
      background: url("background.gif") no-repeat center center fixed;
      background-size: cover;
      animation: gradientBG 12s ease infinite;
    }

    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    header { 
      font-size: 2em; 
      font-weight: bold; 
      margin-bottom: 10px; 
      text-shadow: 2px 2px 5px rgba(0,0,0,0.5);
    }

    #bgControl {
      margin: 10px auto;
      max-width: 400px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
    }

    #topbar { 
      display: flex; 
      justify-content: space-between; 
      max-width: 700px; 
      margin: 0 auto 10px auto; 
      font-size: 1.1em; 
    }

    #progressContainer {
      width: 80%;
      max-width: 700px;
      margin: 10px auto;
      background: #e5e7eb;
      border-radius: 20px;
      overflow: hidden;
      height: 20px;
      box-shadow: inset 0 2px 5px rgba(0,0,0,0.2);
    }

    #progressBar {
      width: 0%;
      height: 100%;
      background: linear-gradient(90deg,#22c55e,#3b82f6);
      transition: width 0.5s ease;
    }

    #word { font-size: 2em; margin: 20px 0; letter-spacing: 5px; }

    #choices { 
      display: grid; 
      grid-template-columns: repeat(6, 1fr); 
      gap: 10px; 
      max-width: 700px; 
      margin: 20px auto; 
    }

    .choice { 
      background: #e5e7eb; 
      border-radius: 8px; 
      padding: 15px; 
      cursor: pointer; 
      font-size: 1.2em; 
      transition: 0.2s; 
      user-select: none;
      border: 2px solid black;
    }
    .choice:hover { background: #d1d5db; }
    .choice.correct { background: #22c55e !important; color: white; }
    .choice.wrong { background: #ef4444 !important; color: white; }

    #feedback { font-size: 1.2em; margin-top: 15px; min-height: 30px; }

    #imageContainer { 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      gap: 15px; 
      margin: 10px auto; 
    }

    #imagePlaceholder {
      width: 220px; 
      height: 220px; 
      border: 3px dashed #9ca3af; 
      border-radius: 10px;
      display: flex; 
      align-items: center; 
      justify-content: center; 
      background: rgba(255,255,255,0.6);
    }

    #image {
      max-width: 200px; 
      max-height: 200px;
      display: block;
    }

    #soundBtn { 
      background: #38bdf8; 
      border: none; 
      border-radius: 50%; 
      width: 50px; 
      height: 50px; 
      cursor: pointer; 
      font-size: 1.5em; 
      color: white; 
      transition: 0.2s; 
    }
    #soundBtn:hover { background: #0ea5e9; }

    #nextBtn { 
      display: none; 
      margin-top: 20px; 
      padding: 10px 20px; 
      font-size: 1.2em; 
      border: none; 
      border-radius: 8px; 
      background: #22c55e; 
      color: white; 
      cursor: pointer; 
      transition: 0.2s; 
    }
    #nextBtn:hover:enabled { background: #16a34a; }
    #nextBtn:disabled { background: #9ca3af; cursor: not-allowed; }

    #resultBox {
      font-size: 1.3em;
      margin-top: 20px;
      opacity: 0;
      transform: scale(0.8);
      transition: opacity 0.6s ease, transform 0.6s ease;
    }
    #resultBox.show {
      opacity: 1;
      transform: scale(1);
    }

    #tryAgainBtn { 
      display:none; 
      margin-top:20px; 
      padding:10px 20px; 
      font-size:1.2em; 
      border:none; 
      border-radius:8px; 
      background:#3b82f6; 
      color:white; 
      cursor:pointer; 
      transition:0.2s; 
    }
    #tryAgainBtn:hover { background:#2563eb; }

    /* Mascot */
    #mascot {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 120px;
      z-index: 1000;
      animation: bounce 3s infinite ease-in-out;
      cursor: pointer;
    }

    @keyframes bounce {
      0%,100% { transform: translateY(0); }
      50% { transform: translateY(-15px); }
    }

    @keyframes fly {
      0% { transform: translate(0,0) rotate(0deg); }
      25% { transform: translate(20px,-20px) rotate(10deg); }
      50% { transform: translate(-20px,-10px) rotate(-10deg); }
      75% { transform: translate(10px,-15px) rotate(5deg); }
      100% { transform: translate(0,0) rotate(0deg); }
    }

    @keyframes shake {
      0% { transform: rotate(0deg); }
      25% { transform: rotate(10deg); }
      50% { transform: rotate(-10deg); }
      75% { transform: rotate(10deg); }
      100% { transform: rotate(0deg); }
    }

    /* Popup speech bubble */
    #popup {
      position: fixed;
      bottom: 160px;
      right: 40px;
      background: #fff;
      border: 2px solid #333;
      border-radius: 10px;
      padding: 10px 15px;
      font-size: 1.1em;
      box-shadow: 2px 2px 8px rgba(0,0,0,0.3);
      display: none;
      animation: fadeInOut 3s forwards;
      max-width: 200px;
    }
    @keyframes fadeInOut {
      0% { opacity: 0; transform: scale(0.8); }
      10% { opacity: 1; transform: scale(1); }
      90% { opacity: 1; }
      100% { opacity: 0; transform: scale(0.8); }
    }
  </style>
</head>
<body>
  <header>e-Board -- Guess the Initial Blending Sounds</header>

  <!-- Background Music Controls -->
  <div id="bgControl">
    <button id="playBgBtn">‚ñ∂Ô∏è Play Music</button>
    <label>Volume: <input type="range" id="bgVolume" min="0" max="100" value="20"></label>
  </div>

  <div id="topbar">
    <div id="points">Points: 0</div>
    <div id="counter">Question: 1 / 12</div>
  </div>

  <div id="progressContainer"><div id="progressBar"></div></div>
  <hr>

  <div id="imageContainer">
    <div id="imagePlaceholder">
      <img id="image" src="" alt="word image">
    </div>
    <button id="soundBtn">üîä</button>
  </div>

  <div id="word">__</div>
  <div id="choices"></div>
  <div id="feedback"></div>

  <button id="nextBtn" disabled>Next ‚û°Ô∏è</button>
  <div id="resultBox"></div>
  <button id="tryAgainBtn">üîÑ TRY AGAIN</button>

  <img id="mascot" src="normal.png" alt="Mascot">
  <div id="popup"></div>

  <!-- Sounds -->
  <audio id="correctSound" src="correct.mp3"></audio>
  <audio id="wrongSound" src="wrong.mp3"></audio>
  <audio id="wordSound"></audio>
  <audio id="confettiSound" src="confetti.mp3" loop></audio>
  <audio id="bgMusic" src="bmusic.mp3" loop></audio>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
  <script>
    const gameData = [
      {word: "__AGON", answer: "DR", image: "dragon.jpg", sound: "dragon.mp3"},
      {word: "__EE", answer: "TR", image: "tree.jpg", sound: "tree.mp3"},
      {word: "__UIT", answer: "FR", image: "fruit.jpg", sound: "fruit.mp3"},
      {word: "__EY", answer: "GR", image: "grey.jpg", sound: "grey.mp3"},
      {word: "__AYON", answer: "CR", image: "crayon.jpg", sound: "crayon.mp3"},
      {word: "__USH", answer: "BR", image: "brush.jpg", sound: "brush.mp3"},
      {word: "__ETTY", answer: "PR", image: "pretty.jpg", sound: "pretty.mp3"},
      {word: "__Y", answer: "FL", image: "fly.jpg", sound: "fly.mp3"},
      {word: "__UE", answer: "GL", image: "glue.jpg", sound: "glue.mp3"},
      {word: "__AP", answer: "CL", image: "clap.jpg", sound: "clap.mp3"},
      {word: "__ANE", answer: "PL", image: "plane.jpg", sound: "plane.mp3"},
      {word: "__ONDE", answer: "BL", image: "blonde.jpg", sound: "blonde.mp3"},
    ];

    const choices = ["DR","TR","FR","GR","CR","BR","PR","PL","FL","GL","CL","BL"];
    let score = 0, currentIndex = 0, questions = [];
    let confettiInterval = null;
    let gradeNow = "";

    const img = document.getElementById("image");
    const wordDiv = document.getElementById("word");
    const pointsDiv = document.getElementById("points");
    const feedback = document.getElementById("feedback");
    const choicesDiv = document.getElementById("choices");
    const counterDiv = document.getElementById("counter");
    const soundBtn = document.getElementById("soundBtn");
    const wordSound = document.getElementById("wordSound");
    const nextBtn = document.getElementById("nextBtn");
    const resultBox = document.getElementById("resultBox");
    const tryAgainBtn = document.getElementById("tryAgainBtn");
    const correctSound = document.getElementById("correctSound");
    const wrongSound = document.getElementById("wrongSound");
    const confettiSound = document.getElementById("confettiSound");
    const progressBar = document.getElementById("progressBar");
    const mascot = document.getElementById("mascot");
    const popup = document.getElementById("popup");
    const bgMusic = document.getElementById("bgMusic");
    const playBgBtn = document.getElementById("playBgBtn");
    const bgVolume = document.getElementById("bgVolume");

    const encouragements = [
      "üåü Great job!", "üëç Keep going!", "üî• You‚Äôre amazing!", "üí° Smart choice!", "üëè Well done!"
    ];

    const wrongEncouragements = [
      "üò¢ Oops, try again!", "üòì Not quite, keep practising!", "üôÅ Don't give up!", "üíß Almost there!", "üòü Listen carefully!"
    ];

    function shuffleArray(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
    }

    function startGame() {
      score = 0;
      currentIndex = 0;
      shuffleArray(gameData);
      questions = gameData.slice(0, 12);
      pointsDiv.textContent = "Points: 0";
      resultBox.textContent = "";
      resultBox.classList.remove("show");
      tryAgainBtn.style.display = "none";
      document.getElementById("imageContainer").style.display = "flex";
      wordDiv.style.display = "block";
      choicesDiv.style.display = "grid";
      nextBtn.style.display = "inline-block";
      stopConfetti();
      updateProgress();
      loadQuestion();
      mascot.src = "normal.png";
      mascot.style.animation = "bounce 3s infinite ease-in-out";
      bgMusic.volume = bgVolume.value / 100;
    }

    // Background music controls
    playBgBtn.onclick = () => { bgMusic.play(); };
    bgVolume.oninput = () => { bgMusic.volume = bgVolume.value / 100; };

    function showPopup(message) {
      popup.textContent = message;
      popup.style.display = "block";
      setTimeout(()=>{ popup.style.display="none"; }, 3000);
    }

    function resetChoices() {
      document.querySelectorAll(".choice").forEach(btn => {
        btn.classList.remove("correct", "wrong");
        btn.style.pointerEvents = "auto";
      });
    }

    function loadQuestion() {
      if (currentIndex >= questions.length) { showResult(); return; }
      const q = questions[currentIndex];
      img.src = q.image;
      wordDiv.textContent = q.word;
      feedback.textContent = "";
      counterDiv.textContent = "Question: " + (currentIndex+1) + " / " + questions.length;
      nextBtn.disabled = true;
      wordSound.src = q.sound;
      resetChoices();
      updateProgress();
    }

    function updateProgress() {
      let percent = (currentIndex / 12) * 100;
      progressBar.style.width = percent + "%";
    }

    function showMascotMood(correct) {
      if(correct) {
        mascot.src = "happy.png";
        mascot.style.animation = "fly 1.5s ease-in-out";
      } else {
        mascot.src = "angry.png";
        mascot.style.animation = "shake 0.5s";
      }
      setTimeout(() => {
        mascot.src = "normal.png";
        mascot.style.animation = "bounce 3s infinite ease-in-out";
      }, 1500);
    }

    function checkAnswer(button, selected) {
      const q = questions[currentIndex];
      if (selected === q.answer) {
        score++;
        pointsDiv.textContent = "Points: " + score;
        feedback.textContent = "‚úÖ Correct!";
        correctSound.play();
        button.classList.add("correct");
        showMascotMood(true);
        showPopup(encouragements[Math.floor(Math.random()*encouragements.length)]);
      } else {
        feedback.textContent = "‚ùå Wrong!";
        wrongSound.play();
        button.classList.add("wrong");
        document.querySelectorAll(".choice").forEach(btn => {
          if (btn.textContent === q.answer) btn.classList.add("correct");
        });
        showMascotMood(false);
        showPopup(wrongEncouragements[Math.floor(Math.random()*wrongEncouragements.length)]);
      }
      wordDiv.textContent = q.answer + q.word.slice(2);
      document.querySelectorAll(".choice").forEach(btn => { btn.style.pointerEvents = "none"; });
      nextBtn.disabled = false;
    }

    nextBtn.onclick = () => {
      [correctSound, wrongSound, wordSound].forEach(audio => { audio.pause(); audio.currentTime = 0; });
      currentIndex++;
      loadQuestion();
    };

    soundBtn.onclick = () => { wordSound.play(); };

    function showResult() {
      document.getElementById("imageContainer").style.display = "none";
      wordDiv.style.display = "none";
      choicesDiv.style.display = "none";
      counterDiv.textContent = "";
      nextBtn.style.display = "none";
      progressBar.style.width = "100%";

      let grade = "", notes = "";
      if (score >= 10) { grade = "A"; }
      else if (score >= 7) { grade = "B"; notes="üëâ Keep practising!"; }
      else if (score >= 5) { grade = "C"; notes="üìò Revise more."; }
      else if (score >= 3) { grade = "D"; notes="‚úèÔ∏è Listen carefully."; }
      else { grade = "E"; notes="üîÑ Practise basics."; }

      gradeNow = grade;
      resultBox.innerHTML = `üéØ Final Score: ${score}/12 <br> üèÖ Grade: <b>${grade}</b><br>${notes}`;
      resultBox.classList.add("show");
      tryAgainBtn.style.display = "inline-block";

      if (["A","B","C"].includes(grade)) startConfetti(grade);
      bgMusic.pause(); // pause music when showing result
    }

    function startConfetti(grade) {
      stopConfetti();
      confettiSound.play();
      if (grade === "A") {
        confettiInterval = setInterval(()=>{ confetti({particleCount:150,spread:120,scalar:1.2,origin:{y:0.6}}); },700);
      } else if (grade === "B") {
        confettiInterval = setInterval(()=>{ confetti({particleCount:100,spread:80,scalar:0.9,colors:["#a78bfa","#60a5fa","#34d399"],origin:{y:0.7}}); },1200);
      } else if (grade === "C") {
        confettiInterval = setInterval(()=>{ confetti({particleCount:60,spread:60,scalar:0.7,colors:["#fde68a","#fcd34d","#fbbf24"],origin:{y:0.8}}); },1500);
      }
    }
    function stopConfetti() {
      if (confettiInterval) { clearInterval(confettiInterval); confettiInterval=null; }
      confettiSound.pause(); confettiSound.currentTime=0;
    }

    tryAgainBtn.onclick = () => { startGame(); };

    // Initialize choice buttons
    choices.forEach(c => {
      const btn = document.createElement("div");
      btn.className = "choice";
      btn.textContent = c;
      btn.onclick = () => checkAnswer(btn, c);
      choicesDiv.appendChild(btn);
    });

    startGame();
  </script>
</body>
</html>
